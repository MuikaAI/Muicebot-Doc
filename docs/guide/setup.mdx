# å¿«é€Ÿå¼€å§‹ğŸ’»

æœ¬æŒ‡å—å°†æŒ‡å¯¼æ‚¨åœ¨ç°æœ‰çš„ NoneBot2 é¡¹ç›®ä¸­å¿«é€Ÿé›†æˆæœ¬ Bot æœåŠ¡ã€‚

å»ºè®®ç¯å¢ƒï¼š

- Python 3.10 åŠä»¥ä¸Š Python ç‰ˆæœ¬


## å®‰è£…æ’ä»¶âš™ï¸

MuiceBot å°†ä½œä¸º Nonebot2 æ’ä»¶çš„æ–¹å¼æä¾›å®‰è£…

### é€šè¿‡åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…

æ­¤æ–¹å¼éœ€è¦åŸºäºä¸€ä¸ªå·²ç»å­˜åœ¨çš„ Nonebot2 é¡¹ç›®ã€‚å¦‚éœ€æ–°å»ºé¡¹ç›®ï¼Œè¯·å‚è€ƒ: [å¿«é€Ÿä¸Šæ‰‹ | Nonebot](https://nonebot.dev/docs/quick-start#%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE)

æˆ– [ä» Muice-Chatbot è¿ç§»è‡³ MuiceBot](https://www.bilibili.com/opus/1053416496894574593) ä¸­çš„åˆ›å»º Nonebot2 æœºå™¨äººé¡¹ç›®éƒ¨åˆ†

import { Tab, Tabs } from 'rspress/theme';

<Tabs>
  <Tab label="pip">
```shell
pip install muicebot
```
  </Tab>

  <Tab label="pdm">
```shell
pdm add muicebot
```
  </Tab>

  <Tab label="poetry">
```shell
poetry add muicebot
```
  </Tab>

  <Tab label="conda">
```shell
conda instll muicebot
```
  </Tab>

  <Tab label="uv">
```shell
uv add muicebot
```
  </Tab>

</Tabs>

é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¼šä»…å®‰è£… `OpenAI` åŠ è½½å™¨æ‰€éœ€çš„ä¾èµ–ï¼Œè¦æƒ³å®Œæ•´å®‰è£…æ‰€æœ‰æ¨¡å‹åŠ è½½å™¨çš„ä¾èµ–ï¼Œè¯·æ‰§è¡Œï¼š

<Tabs>
  <Tab label="pip">
```shell
pip install muicebot[standard]
```
  </Tab>

  <Tab label="pdm">
```shell
pdm add muicebot[standard]
```
  </Tab>

  <Tab label="poetry">
```shell
poetry add muicebot[standard]
```
  </Tab>

  <Tab label="conda">
```shell
conda instll muicebot[standard]
```
  </Tab>

  <Tab label="uv">
```shell
uv add muicebot[standard]
```
  </Tab>

</Tabs>

å®Œæˆå®‰è£…åï¼Œè¯·æ‰‹åŠ¨ç¼–è¾‘ Nonebot2 é¡¹ç›®ä¸­çš„ `pyproject.toml`, åœ¨ `[tool.nonebot]` éƒ¨åˆ†è¿½åŠ æ’ä»¶:

```toml
plugins = ["muicebot"]
```

### é€šè¿‡ git clone çš„æ–¹å¼è¿›è¡Œå®‰è£…(Dev)

```
git clone https://github.com/Moemu/Muicebot.git
cd Muicebot
pip install .  # pip install .[standard]
```

æ’ä»¶å®‰è£…å®Œæ¯•åï¼Œä¸ºäº†æ­£å¸¸å¯åŠ¨ Nonebot æœåŠ¡ï¼Œè¯·ç¡®è®¤æ‚¨å·²å®‰è£… Nonebot é€‚é…å™¨æ‰€éœ€çš„é©±åŠ¨å™¨ï¼Œæ¨èçš„é…ç½®å¦‚ä¸‹ï¼š

```dotenv
DRIVER=~fastapi+~websockets+~httpx
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è¿›è¡Œä¸€äº›å¿…è¦é¡¹çš„é…ç½®æ¥æˆåŠŸå¯åŠ¨ Muicebot

## æ¨¡å‹é…ç½®

æ­¤èŠ‚è¦æ±‚ä½ æ‹¥æœ‰ä¸€ä¸ªçœŸå®çš„æ¨¡å‹æœåŠ¡ç«¯åŠ api_key

åœ¨æœºå™¨äººç›®å½•ä¸‹åˆ›å»º `configs` æ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ç”¨äºå­˜å‚¨ Muicebot çš„é…ç½®æ–‡ä»¶

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª `models.yml` æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ç”¨äºæ”¾ç½®æ¨¡å‹ç›¸å…³çš„é…ç½®

åˆ›å»º `models.yml` æ–‡ä»¶ï¼Œä» [æ¨¡å‹åŠ è½½å™¨åˆ—è¡¨](/guide/model#å®ç°çš„åŠ è½½å™¨åŠå…¶æ”¯æŒçš„æ¨¡å‹) ä¸­é€‰æ‹©ä¸€ä¸ªä½ æ‰€ç†Ÿæ‚‰çš„æ¨¡å‹æœåŠ¡æä¾›å•†çš„SDKå¹¶è¿›è¡Œç›¸å…³é…ç½®ã€‚

ä»¥ `Openai` åŠ è½½å™¨ä¸ºä¾‹ï¼Œè¿™ä¸ªåŠ è½½å™¨å¯ç”¨äºåŠ è½½ `OpenAI API` å…¼å®¹çš„ API æ¨¡å‹æ¥å£ã€‚

åœ¨ `models.yml` ä¸­å†™å…¥:

```yaml
qwen3:
  loader: Openai # ä½¿ç”¨ openai åŠ è½½å™¨ï¼ˆå¿…å¡«ï¼‰
  model_name: qwen3-235b-a22b # æ¨¡å‹åç§°ï¼ˆå¿…å¡«ï¼‰
  api_key: <YOUR-OPENAI-API-KEY> # API å¯†é’¥ï¼ˆå¿…é¡»ï¼‰
  api_host: https://dashscope.aliyuncs.com/compatible-mode/v1 # æœåŠ¡å™¨ API æ¥å£åœ°å€ ï¼ˆå¯é€‰ï¼Œé»˜è®¤ OpenAI æœåŠ¡ï¼‰
  template: Muice # ä½¿ç”¨çš„æ¨¡æ¿åç§°ï¼ˆå¯é€‰ï¼Œæ— é»˜è®¤å€¼ï¼‰
  stream: true # æµå¼å¯¹è¯
  multimodal: false # æ˜¯å¦å¯ç”¨å¤šæ¨¡æ€ï¼ˆå¯é€‰ã€‚æ³¨æ„ï¼šä½¿ç”¨çš„æ¨¡å‹å¿…é¡»æ˜¯å¤šæ¨¡æ€çš„ï¼‰
  function_call: true # æ˜¯å¦å¯ç”¨å·¥å…·è°ƒç”¨ï¼ˆå¯é€‰ã€‚éœ€è¦ç¼–å†™ function call æ’ä»¶å¹¶å¯ç”¨ï¼‰
```

ä»¥ä¸Šçš„å†…å®¹å®šä¹‰äº†ä¸€ä¸ªåä¸º `qwen3` çš„æ¨¡å‹é…ç½®å¹¶ä½¿ç”¨ `OpenAI` æ¨¡å‹åŠ è½½å™¨åŠ è½½ï¼Œè¿™ä¸ªæ¨¡å‹åŠ è½½å™¨å°†ä¼šè°ƒç”¨ DashScope çš„ `qwen3-235b-a22b` æ¨¡å‹å¹¶å¯ç”¨æµå¼è¾“å‡ºå’Œå·¥å…·è°ƒç”¨

æœ‰å…³å„æ¨¡å‹åŠ è½½å™¨çš„ç›¸å…³ä¿¡æ¯å’Œå…·ä½“é…ç½®ï¼Œè¯·å‚è€ƒ [æ¨¡å‹åŠ è½½å™¨ä¿¡æ¯](/guide/model) ä¸€èŠ‚

é™¤æ­¤ä¹‹å¤–ï¼Œæ­¤æ¨¡å‹åŠ è½½å™¨ä½¿ç”¨äº†ä¸€ä¸ªåä¸º `Muice` çš„äººè®¾æ¨¡æ¿ï¼Œè¿™ä¸ªæ¨¡æ¿ä¼šåœ¨å¯¹è¯æ—¶è¢«ä½¿ç”¨å¹¶å®æ—¶ç”Ÿæˆç³»ç»Ÿæç¤ºä¼ å…¥åˆ° LLM ä¸­

æœ‰å…³äººè®¾æ¨¡æ¿çš„ç›¸å…³ä¿¡æ¯ï¼Œè¯·å‚è€ƒ [äººè®¾æ¨¡æ¿](/guide/template) ä¸€èŠ‚

## æ•°æ®åº“è¿ç§»

åœ¨æ­£å¼å¯åŠ¨ Bot ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜è¦å¯¹æ•°æ®åº“è¿›è¡Œè¿ç§»æ“ä½œï¼ˆå»ºè¡¨ï¼‰

åœ¨ Bot ç›®å½•ä¸‹æ‰§è¡Œ:

```bash
nb orm upgrade
```

å¦‚æœæ²¡æœ‰æŠ¥é”™æç¤ºï¼Œåˆ™è¯´æ˜æ•°æ®åº“è¿ç§»æˆåŠŸï¼Œå¯ä»¥æ­£å¼å¯åŠ¨ Bot äº†

## å¯åŠ¨ Muicebot

å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä»¥ QQ é€‚é…å™¨ä¸ºä¾‹ï¼Œåœ¨è¿è¡Œ `nb run` åï¼Œä½ å°†ä¼šçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼Œè¿™è¡¨æ˜ Bot å·²ç»å¼€å§‹å·¥ä½œï¼š

```shell
(MuxueBot) C:\Users\Muika\Desktop\nonebot-plugin-muice>nb run
[SUCCESS] init: NoneBot is initializing...
[INFO] init: Current Env: prod
[SUCCESS] load_plugin: Succeeded to load plugin "nonebot_plugin_alconna:uniseg" from "nonebot_plugin_alconna.uniseg"
[SUCCESS] load_plugin: Succeeded to load plugin "nonebot_plugin_waiter"
[SUCCESS] load_plugin: Succeeded to load plugin "nonebot_plugin_alconna"
[SUCCESS] load_plugin: Succeeded to load plugin "nonebot_plugin_localstore"
[SUCCESS] load_plugin: Succeeded to load plugin "nonebot_plugin_apscheduler"
[INFO] __init__: æ•°æ®åº“è·¯å¾„: C:\Users\Muika\AppData\Local\nonebot2\Muice\ChatHistory.db
[SUCCESS] load_plugin: Succeeded to load plugin "Muice"
[SUCCESS] run: Running NoneBot...
[SUCCESS] run: Loaded adapters: OneBot V12, OneBot V11, Telegram, QQ
[INFO] _serve: Started server process [40776]
[INFO] startup: Waiting for application startup.
[INFO] _start_scheduler: Scheduler Started
[INFO] load_model: æ­£åœ¨åŠ è½½æ¨¡å‹...
[INFO] load_model: æ¨¡å‹åŠ è½½æˆåŠŸ
[INFO] on_startup: MuiceAI èŠå¤©æ¡†æ¶å·²å¼€å§‹è¿è¡Œâ­
[INFO] startup: Application startup complete.
[INFO] _log_started_message: Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
[INFO] log: QQ | Bot 123456789 connected
```

ç°åœ¨ï¼Œå½“ä½  @ æœºå™¨äººæˆ–æ‰§è¡Œå‘½ä»¤æ—¶ Bot å°†å¼€å§‹å›å¤æ¶ˆæ¯æµç¨‹ï¼Œé™¤æ­¤ä¹‹å¤–å®ƒä¸ä¼šåšä»»ä½•äº‹ï¼Œé™¤éå®šæ—¶ä»»åŠ¡å¼€å§‹ã€‚

èµ¶ç´§ @bot æ¥æ„‰å¿«åœ°å’Œæœºå™¨äººç©è€å§ï¼â­